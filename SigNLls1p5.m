% 2016/12/19 完
% 2018/11/13 增加缺失项
% 2018/11/19 分部积分part5
% 默认修改d2zn1,d3zn1
function y = SigNLls1p5(w,nl)
global w0 ve wpe wce E0x E0y E0z de1 nx ny nz n0x n0z n1x n1y n1z n1per;
w1 = w-1;
cE0x = conj(E0x);
cE0y = conj(E0y);
cE0z = conj(E0z);
E01 = E0x-1i.*E0y;
E02 = E0x+1i.*E0y;
E03 = cE0x+1i.*cE0y;
E04 = cE0x-1i.*cE0y;
d1m = exp(-1i.*de1);
d1p = exp(1i.*de1);
zz = 1./nz./ve;
z0z = 1./n0z./ve;
z1z = 1./n1z./ve;
p0 = n0x.*ve./wce;
p1 = n1per.*ve./wce;
px = nx.*ve./wce;
py = ny.*ve./wce;
p0x = n0x.*ve./wce;
p1x = n1x.*ve./wce;
p1y = n1y.*ve./wce;
q0x = n0x.*ve;
q0 = n0x.*ve;
q1 = n1per.*ve./w1;
q1x = n1x.*ve./w1;
q1y = n1y.*ve./w1;
q1z = n1z.*ve./w1;
q0z = n0z.*ve;
kz = nz.*ve;
k1z = n1z.*ve;
SigNLxx = 0;
SigNLxy = 0;
SigNLxz = 0;
SigNLyx = 0;
SigNLyy = 0;
SigNLyz = 0;
SigNLzx = 0;
SigNLzy = 0;
SigNLzz = 0;
for n = -nl:nl
    for l1 = -nl:nl
        for l = -nl:nl
            % 有用的项
                % 待删
                % E0xy1 = (E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x));
                % E0xy2 = (E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x));
                % E0xy3 = (E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))));
                % E0xy4 = (E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))));
                % E0xy5 = (E01.*(-besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))-E02.*(-besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))));
                % E0xy6 = (E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x));
                % d1J0l = ((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x));
                % d1J0n = ((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x));
                % d1J0m = ((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x));
                % d1J0p = ((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x));
                % d1J1l = (l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x));
                % d1J1m = ((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x));
                % d1J1p = ((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x));
                % d2J0l = (((l1-l).*(l1-l-1)./(p0.*x).^2-1).*besselj(l1-l,p0.*x)+besselj(l1-l+1,p0.*x)./(p0.*x));
                % d2J0m = (((l1-l-1).*(l1-l-2)./(p0.*x).^2-1).*besselj(l1-l-1,p0.*x)+besselj(l1-l,p0.*x)./(p0.*x));
                % d2J0p = (((l1-l+1).*(l1-l)./(p0.*x).^2-1).*besselj(l1-l+1,p0.*x)+besselj(l1-l+2,p0.*x)./(p0.*x));
                % d2J1l = ((l.*(l-1)./(p1.*x).^2-1).*besselj(l,p1.*x)+besselj(l+1,p1.*x)./(p1.*x));
                % d2J1m = (((l-1).*(l-2)./(p1.*x).^2-1).*besselj(l-1,p1.*x)+besselj(l,p1.*x)./(p1.*x));
                % d2J1p = (((l+1).*(l)./(p1.*x).^2-1).*besselj(l+1,p1.*x)+besselj(l+2,p1.*x)./(p1.*x));
            % 等离子体色散函数
            zl = (w-l1.*wce)./nz./ve;
            zl0 = (1-(l1-l).*wce)./n0z./ve;
            zn0 = (1-(l1-n).*wce)./n0z./ve;
            zn1 = (w1-n.*wce)./n1z./ve;
            zl1 = (w1-l.*wce)./n1z./ve;
            d1zl = -2.*(1+zl.*Z(zl));
            d1zl0 = -2.*(1+zl0.*Z(zl0));
            d1zn1 = -2.*(1+zn1.*Z(zn1));
            d1zl1 = -2.*(1+zl1.*Z(zl1));
            d2zl0 = -2.*(Z(zl0)+zl0.*d1zl0);
            % d2zl0 = -2.*(1./zl0.^3+3./zl0.^5-15./8./zl0.^7);
            % d2zn1 = -2.*(Z(zn1)+zn1.*d1zn1);
            d2zn1 = -2.*(1./zn1.^3+3./zn1.^5-15./8./zn1.^7);
            d2zl1 = -2.*(Z(zl1)+zl1.*d1zl1);
            % d2zl1 = -2.*(1./zl1.^3+3./zl1.^5-15./8./zl1.^7);
            % d3zn1 = -2.*(2.*d1zn1+zn1.*d2zn1);
            d3zn1 = 6./zn1.^4-45./2./zn1.^6;
            % 分情况讨论
            if n == l
                Cznzl = 1./(n1z.*ve).^2.*d1zn1;
                Cznzl2 = -0.5./(n1z.*ve).^3.*d2zn1;
                Cznzl3 = z1z.^4./6.*d3zn1;
                Cznzl4 = -0.5.*z1z.^3.*d2zn1;
                Cznzl5 = 1./6.*z1z.^4.*d3zn1;
            else
                Cznzl = -1./n1z./ve./(n-l)./wce.*(Z(zn1)-Z(zl1));
                Cznzl2 = -1./n1z./ve./(n-l)./wce.*(1./n1z./ve.*d1zl1+1./(n-l)./wce.*(Z(zn1)-Z(zl1)));
                Cznzl3 = z1z./(n-l)./wce.*(-1./(n-l)./wce.*(z1z.*d1zl1+1./(n-l)./wce.*(Z(zn1)-Z(zl1)))+0.5.*z1z.^2.*d2zl1);
                Cznzl4 = z1z./(n-l)./wce.*(z1z.*d1zn1+1./(n-l)./wce.*(Z(zn1)-Z(zl1)));
                Cznzl5 = z1z.*(1./(n-l)./wce).^2.*(2./(n-l)./wce.*(Z(zn1)-Z(zl1))+z1z.*(d1zn1+d1zl1));
            end
            % 具体值
            Czlzl1 = (Z(zl)-Z(zl1))./(zl-zl1);
            Czlzn1 = (Z(zl)-Z(zn1))./(zl-zn1);
            Czlzl0 = (Z(zl)-Z(zl0))./(zl-zl0);
            Czl0zn1 = (Z(zl0)-Z(zn1))./(zl0-zn1);
            Zb0101 = zz.^2.*d1zl;
            Zb0102 = z1z.^2.*d1zn1;
            Zb0201 = zz.*z1z.*Czlzn1;
            Zb0301 = -1./(zl-zn1).*(z1z.*Zb0101-zz.*Zb0201);
            Zb0302 = -1./(zl-zn1).*(z1z.*Zb0201-zz.*Zb0102);
            Z15 = -zz./(zl-zl1).*(z1z.^2.*Czlzn1-Cznzl);
            Z16 = -zz.*z1z.^2.*Czlzl1+zn1.*Z15;
            Z17 = -zz.*z1z.^2.*(Z(zl)+zl1.*Czlzl1)+zn1.*Z16;
            Z23 = -zz.*z1z.^2.*(1+zl.*Z(zl)+zl1.*Z(zl1)+zl.*zl1.*Czlzl1)+zn1.*Z17;
            Z26 = -zz.*z1z.^2.*(zl.*(1+zl.*Z(zl))+zn1.*(1+zl.*Z(zl)+zn1.*Z(zn1)+zl.*zn1.*Czlzn1))+zl1.*Z23;
            Z20 = -1./(zl-zl1).*(z1z.*Z15-zz.*Cznzl2);
            Z21 = -z1z.*Z15+zl1.*Z20;
            Z25 = -z1z.*Z16+zl1.*Z21;
            Z38 = -1./(zl-zl1).*(z1z.*Z20-zz.*Cznzl3);
            Z3 = (1+(n-l1).*wce).*Z15-q0z.*Z16;
            Z2 = (1+(n-l1).*wce).*Z16-q0z.*Z17;
            Z1 = (1-(l1-l).*wce).*Z3-q0z.*Z2;
            Z4 = Z3-q0z.*Z2;
            Z5 = (1+(n-l1).*wce).*Z20-q0z.*Z21;
            Z6 = (1+(n-l1).*wce).*Z17-q0z.*Z23;
            Z7 = (1-(l1-l).*wce).*Z2-q0z.*Z6;
            Z8 = Z2-q0z.*Z6;
            Z9 = (1+(n-l1).*wce).*Z21-q0z.*Z25;
            Z10 = (1+(n-l1).*wce).*Z23-q0z.*Z26;
            Z11 = (1-(l1-l).*wce).*Z6-q0z.*Z10;
            Z12 = Z6-q0z.*Z10;
            Z13 = (1-(l1-l).*wce).*Z15-q0z.*Z16;
            Z14 = (1-(l1-l).*wce).*Z16-q0z.*Z17;
            Z18 = Z15-q0z.*Z16;
            Z19 = Z16-q0z.*Z17;
            Z22 = (1-(l1-l).*wce).*Z17-q0z.*Z23;
            Z24 = Z17-q0z.*Z23;
            Z27 = Z23-q0z.*Z26;
            Z28 = (1-(l1-l).*wce).*Z23-q0z.*Z26;
            Z29 = (1-(l1-l).*wce).*Z18-q0z.*Z19;
            Z30 = Z18-q0z.*Z19;
            Z31 = Z20-q0z.*Z21;
            Z32 = Z14-q0z.*Z22;
            Z33 = Z19-q0z.*Z24;
            Z34 = Z21-q0z.*Z25;
            Z35 = Z22-q0z.*Z28;
            Z36 = Z24-q0z.*Z27;
            Z37 = (1-(l1-l).*wce).*Z20-q0z.*Z21;
            Z39 = (1-(l1-l).*wce).*Z21-q0z.*Z25;
            Z40 = -z1z.*Z20+zl1.*Z38;
            Z013 = -zz.*z0z.*z1z./(zl-zn1).*(Czlzl0-Czl0zn1);
            Z014 = -zz.*z0z.*z1z.*Czlzn1+zl0.*Z013;
            Z015 = -zz.*z0z.*z1z.*(Z(zl)+zn1.*Czlzn1)+zl0.*Z014;
            Z016 = -zz.*z0z.*z1z.*(1+zl.*Z(zl)+zn1.*Z(zn1)+zl.*zn1.*Czlzn1)+zl0.*Z015;
            Z025 = -zz.*z0z.*z1z.*(zl.*(1+zl.*Z(zl))+zn1.*(1+zl.*Z(zl)+zn1.*Z(zn1)+zl.*zn1.*Czlzn1))+zl0.*Z016;
            Z023 = z0z./(zl0-zn1).*(zz.*z0z.*z1z./(zl-zl0).*(Czlzl0-d1zl0)+Z013);
            Z024 = -z0z.*Z013+zl0.*Z023;
            Z028 = -z0z.*Z014+zl0.*Z024;
            Z043 = -z0z./(zl0-zn1).*(zz.*z0z.^2.*z1z./(zl-zl0).*(1./(zl-zl0).*(Czlzl0-d1zl0)-0.5.*d2zl0)-Z023);
            Z02 = (1+(n-l1).*wce).*Z013-q0z.*Z014;
            Z01 = (1+(n-l1).*wce).*Z014-q0z.*Z015;
            Z03 = (1+(n-l1).*wce).*Z015-q0z.*Z016;
            Z04 = (1-l.*wce./w1).*Z01-q1z.*Z03;
            Z05 = (1-l.*wce./w1).*Z02-q1z.*Z01;
            Z06 = Z01-q1z.*Z03;
            Z07 = Z02-q1z.*Z01;
            Z08 = (1+(n-l1).*wce).*Z023-q0z.*Z024;
            Z09 = (1+(n-l1).*wce).*Z016-q0z.*Z025;
            Z010 = (1-l.*wce./w1).*Z03-q1z.*Z09;
            Z011 = Z03-q1z.*Z09;
            Z012 = (1+(n-l1).*wce).*Z024-q0z.*Z028;
            Z017 = Z013-q1z.*Z014;
            Z018 = Z014-q1z.*Z015;
            Z019 = Z015-q1z.*Z016;
            Z020 = (1-l.*wce./w1).*Z013-q1z.*Z014;
            Z021 = (1-l.*wce./w1).*Z014-q1z.*Z015;
            Z022 = (1-l.*wce./w1).*Z015-q1z.*Z016;
            Z026 = Z016-q1z.*Z025;
            Z027 = (1-l.*wce./w1).*Z016-q1z.*Z025;
            Z029 = Z013-q0z.*Z014;
            Z030 = Z014-q0z.*Z015;
            Z031 = Z020-q0z.*Z021;
            Z032 = Z021-q0z.*Z022;
            Z033 = Z017-q0z.*Z018;
            Z034 = Z018-q0z.*Z019;
            Z035 = Z015-q0z.*Z016;
            Z036 = Z023-q0z.*Z024;
            Z037 = Z022-q0z.*Z027;
            Z038 = Z019-q0z.*Z026;
            Z039 = Z016-q0z.*Z025;
            Z040 = Z024-q0z.*Z028;
            Z041 = Z023-q1z.*Z024;
            Z042 = (1-l.*wce./w1).*Z023-q1z.*Z024;
            Z044 = Z024-q1z.*Z028;
            Z045 = (1-l.*wce./w1).*Z024-q1z.*Z028;
            Z046 = -z0z.*Z023+zl0.*Z043;
            Zm01 = -1./(zl-zl1).*(z1z.*Zb0301-zz.*Z15);
            Zm02 = -zz.*Z15+zl.*Zm01;
            Zm03 = -zz.*Z16+zl.*Zm02;
            Zm04 = -zz.*Z17+zl.*Zm03;
            Zm05 = -1./(zl-zl1).*(z1z.*Zm01-zz.*Z20);
            Zm06 = -zz.*Z20+zl.*Zm05;
            Zm07 = Zm01-q0z.*Zm02;
            Zm08 = (1-(l1-l).*wce).*Zm01-q0z.*Zm02;
            Zm09 = Zm02-q0z.*Zm03;
            Zm10 = (1-(l1-l).*wce).*Zm02-q0z.*Zm03;
            Zm11 = Zm03-q0z.*Zm04;
            Zm12 = (1-(l1-l).*wce).*Zm03-q0z.*Zm04;
            Z0m01 = -1./(zl-zl0).*(z0z.*Zb0301-zz.*Z013);
            Z0m02 = -zz.*Z013+zl.*Z0m01;
            Z0m03 = -zz.*Z014+zl.*Z0m02;
            Z0m04 = -zz.*Z015+zl.*Z0m03;
            Z0m05 = -1./(zl-zl0).*(z0z.*Z0m01-zz.*Z023);
            Z0m06 = -zz.*Z023+zl.*Z0m05;
            Z0m07 = Z0m01-q1z.*Z0m02;
            Z0m08 = (1-l.*wce./w1).*Z0m01-q1z.*Z0m02;
            Z0m09 = Z0m02-q1z.*Z0m03;
            Z0m10 = (1-l.*wce./w1).*Z0m02-q1z.*Z0m03;
            Z0m11 = Z0m03-q1z.*Z0m04;
            Z0m12 = (1-l.*wce./w1).*Z0m03-q1z.*Z0m04;
            Zp01 = -1./(zl-zn1).*(z1z.*Z15-zz.*Cznzl4);
            Zp02 = -z1z.*Z15+zn1.*Zp01;
            Zp03 = -z1z.*Z16+zn1.*Zp02;
            Zp04 = -1./(zl-zn1).*(z1z.*Z20-zz.*Cznzl5);
            Zp05 = Zp01-q0z.*Zp02;
            Zp06 = (1-(l1-l).*wce).*Zp01-q0z.*Zp02;
            Zp07 = Zp02-q0z.*Zp03;
            Zp08 = (1-(l1-l).*wce).*Zp02-q0z.*Zp03;
            Z0p01 = -1./(zl0-zn1).*(z1z.*Z013-z0z.*Zb0302);
            Z0p02 = -z1z.*Z013+zn1.*Z0p01;
            Z0p03 = -z1z.*Z014+zn1.*Z0p02;
            Z0p04 = -1./(zl0-zn1).*(z1z.*Z023-z0z.*Z0p01);
            Z0p05 = Z0p01-q1z.*Z0p02;
            Z0p06 = (1-l.*wce./w1).*Z0p01-q1z.*Z0p02;
            Z0p07 = Z0p02-q1z.*Z0p03;
            Z0p08 = (1-l.*wce./w1).*Z0p02-q1z.*Z0p03;
            % 积分
            fxx = @(x) exp(-x.^2).*x.*x./2.*(d1m.*besselj(n-1,p1.*x)+d1p.*besselj(n+1,p1.*x)) ...% x
                .*( ...
                px.*cE0y.*besselj(-(n-l1),p0.*x) ...% xx part1
                .*( ...
                x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f1, E1x
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*Z1 ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*Z1+q0x.*E0z.*besselj(l1-l,p0.*x).*Z2+q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z3) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)).*Z4 ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)).*Z2-q0x.*E0y.*besselj(l1-l,p0.*x).*Z3)) ...
                +1i.*(-x.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f2, E1x
                +0.5.*(d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z4 ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*Z2) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f3, E1x
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*Z2+k1z.*Z5) ...
                +(p0x.*(q1y.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f4, E1x
                .*(E0z.*besselj(l1-l,p0.*x).*Z01+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z02)) ...
                -(l1-l).*(1i./2./x.*(d1p.*besselj(l-1,p1.*x)-d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*Z06+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z07) ...
                +q1y.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x).*Z01+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z02))) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f5, E1x
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))).*Z06 ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))).*Z07) ...
                +1i.*q1z.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f6, E1x
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*Z03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z01) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))).*Z08) ...
                ) ...
                +(-py) ...% xx part2
                .*( ...
                x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f1, E1x
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z1+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z14+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z13) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z1+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z14+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z13) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z3+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z16+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z15)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z4+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z19+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z3+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z16+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z15))) ...
                +1i.*(-x.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f2, E1x
                +0.5.*(d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z4+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z19+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16)) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f3, E1x
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16) ...
                +k1z.*(cE0x.*besselj(-(n-l1),p0.*x).*Z5+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z21+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z20)) ...
                +(p0x.*(q1y.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f4, E1x
                .*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z01+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z015+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z014) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z02+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z014+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z013))) ...
                -(l1-l).*(1i./2./x.*(d1p.*besselj(l-1,p1.*x)-d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z06+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z019+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z018) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z07+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z018+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z017)) ...
                +q1y.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z01+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z015+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z014) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z02+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z014+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z013)))) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f5, E1x
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z06+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z019+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z018) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z07+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z018+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z017)) ...
                +1i.*q1z.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f6, E1x
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z03+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z016+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z01+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z015+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z014)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z08+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z024+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z023)) ...
                ) ...
                +(-l1) ...% xx part3
                .*( ...
                x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f1, E1x
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z14-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z13) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z14-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z13) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z16-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z15)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z19-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z18) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z16-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z15))) ...
                +1i.*(-x.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f2, E1x
                +0.5.*(d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z19-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z18) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16)) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f3, E1x
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16) ...
                +k1z.*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z31-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z21-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z20)) ...
                +(p0x.*(q1y.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f4, E1x
                .*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z015-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z014) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z014-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z013))) ...
                -(l1-l).*(1i./2./x.*(d1p.*besselj(l-1,p1.*x)-d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z019-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z018) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z018-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z017)) ...
                +q1y.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z015-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z014) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z014-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z013)))) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f5, E1x
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z019-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z018) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z018-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z017)) ...
                +1i.*q1z.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f6, E1x
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z016-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z015-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z014)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z036-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z024-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z023)) ...
                ) ...
                +(1i./x) ...% xx part4
                .*( ...
                x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f1, E1x
                .*(p1x.*E0y.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z14) ...
                -p1y.*(E0x.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z14) ...
                +q0x.*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                +q0x./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z16)) ...
                -l.*(1i./2./x.^2.*(E01.*(-besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))-E02.*(-besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z19) ...
                +1i.*q0./x.^2.*E0z.*(-((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))+p0.*x.*(((l1-l).*(l1-l-1)./(p0.*x).^2-1).*besselj(l1-l,p0.*x)+besselj(l1-l+1,p0.*x)./(p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                -q0x.*E0y.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z16))) ...
                +(-x.^2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f1-1, E1x
                +0.5.*(d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(p1x.*E0y.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z14) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z14) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z16)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z19) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z16))) ...
                +1i.*(-x.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f2, E1x
                +0.5.*(d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z19) ...
                +(l1-l).*wce.*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17)) ...
                +1i.*(d1p.*((2.*x.^2-2-0.5./x.^2).*besselj(l-1,p1.*x)-(2.*x-0.5./x).*p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))+0.5.*p1.^2.*(((l-1).*(l-2)./(p1.*x).^2-1).*besselj(l-1,p1.*x)+besselj(l,p1.*x)./(p1.*x))) ...% f2-1, E1x
                +d1m.*((2.*x.^2-2-0.5./x.^2).*besselj(l+1,p1.*x)-(2.*x-0.5./x).*p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))+0.5.*p1.^2.*(((l+1).*(l)./(p1.*x).^2-1).*besselj(l+1,p1.*x)+besselj(l+2,p1.*x)./(p1.*x)))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z19) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17)) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f3, E1x
                .*((1-(l1-l).*wce).*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                +q0z./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(-2.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                +k1z.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z31-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z21)) ...
                +1i.*(-x.^2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f3-1, E1x
                +0.5.*(d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                +k1z.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z31-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z21)) ...
                +(p0x.*(q1y./2.*(d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...% f4, E1x
                +d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z014))) ...
                -(l1-l).*(1i./2./x.^2.*(d1p.*(-besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                -d1m.*(-besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z018)) ...
                +q1y.*p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z014)))) ...
                +(p0x.*(q1y.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f4-1, E1x
                .*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z014))) ...
                -(l1-l).*(1i./2./x.*(d1p.*besselj(l-1,p1.*x)-d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z018)) ...
                +q1y.*besselj(l,p1.*x).*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z014)))) ...
                +0.5i.*(d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...% f5, E1x
                +d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z018)) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f5-1, E1x
                .*(E0z.*(4.*x.*besselj(l1-l,p0.*x)-(4+1./x.^2).*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))+p0.^2./x.*(((l1-l).*(l1-l-1)./(p0.*x).^2-1).*besselj(l1-l,p0.*x)+besselj(l1-l+1,p0.*x)./(p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019) ...
                +(E01.*((2.*x.^2-2-0.5./x.^2).*besselj(l1-l-1,p0.*x)-(2.*x-0.5./x).*p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))+0.5.*p0.^2.*(((l1-l-1).*(l1-l-2)./(p0.*x).^2-1).*besselj(l1-l-1,p0.*x)+besselj(l1-l,p0.*x)./(p0.*x))) ...
                +E02.*((2.*x.^2-2-0.5./x.^2).*besselj(l1-l+1,p0.*x)-(2.*x-0.5./x).*p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))+0.5.*p0.^2.*(((l1-l+1).*(l1-l)./(p0.*x).^2-1).*besselj(l1-l+1,p0.*x)+besselj(l1-l+2,p0.*x)./(p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z018)) ...
                +1i.*q1z./2.*(d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...% f6, E1x
                +d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*(-2.*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z036-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z024)) ...
                +1i.*q1z.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f6-1, E1x
                .*(2.*E0z.*(2.*x.*besselj(l1-l,p0.*x)-p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +(2.*x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                -(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015) ...
                +(-2.*x.*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                +((1-(l1-l).*wce).*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                +q0z./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z036-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z024)) ...
                ) ...
                +1i.*((1+(n-l1).*wce).*cE0z.*besselj(-(n-l1),p0.*x)+q0z.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x))) ...% xx part5
                .*( ...
                (-k1z).*( ...
                x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f1, E1x
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*Zp06 ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*Zp06+q0x.*E0z.*besselj(l1-l,p0.*x).*Zp02+q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Zp01) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)).*Zp05 ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)).*Zp02-q0x.*E0y.*besselj(l1-l,p0.*x).*Zp01)) ...
                +1i.*(-x.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f2, E1x
                +0.5.*(d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Zp05 ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*Zp02) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f3, E1x
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*Zp02+k1z.*Zp04) ...
                +(p0x.*(q1y.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f4, E1x
                .*(E0z.*besselj(l1-l,p0.*x).*Z0p02+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p01)) ...
                -(l1-l).*(1i./2./x.*(d1p.*besselj(l-1,p1.*x)-d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*Z0p07+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p05) ...
                +q1y.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x).*Z0p02+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p01))) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f5, E1x
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))).*Z0p07 ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))).*Z0p05) ...
                +1i.*q1z.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f6, E1x
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*Z0p03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p02) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))).*Z0p04) ...
                ) ...
                ));
            sxx = integral(fxx,0,inf);
            fxy = @(x) exp(-x.^2).*x.*x./2.*(d1m.*besselj(n-1,p1.*x)+d1p.*besselj(n+1,p1.*x)) ...% x
                .*( ...
                px.*cE0y.*besselj(-(n-l1),p0.*x) ...% xy part1
                .*( ...
                x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f1, E1y
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*Z1 ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*Z1+q0x.*E0z.*besselj(l1-l,p0.*x).*Z2+q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z3) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)).*Z4 ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)).*Z2-q0x.*E0y.*besselj(l1-l,p0.*x).*Z3)) ...
                +1i.*(-x.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f2, E1y
                +0.5.*(-1i.*d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z4 ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*Z2) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f3, E1y
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*Z2+k1z.*Z5) ...
                +(p0x.*(besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x).*Z04+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z05) ...% f4, E1y
                +q1y.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*Z01+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z02)) ...
                -(l1-l).*(1i./2./x.*(-1i.*d1p.*besselj(l-1,p1.*x)-1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*Z06+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z07) ...
                -q1x.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x).*Z01+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z02))) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f5, E1y
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))).*Z06 ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))).*Z07) ...
                +1i.*q1z.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f6, E1y
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*Z03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z01) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))).*Z08) ...
                ) ...
                +(-py) ...% xy part2
                .*( ...
                x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f1, E1y
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z1+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z14+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z13) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z1+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z14+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z13) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z3+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z16+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z15)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z4+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z19+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z3+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z16+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z15))) ...
                +1i.*(-x.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f2, E1y
                +0.5.*(-1i.*d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z4+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z19+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16)) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f3, E1y
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16) ...
                +k1z.*(cE0x.*besselj(-(n-l1),p0.*x).*Z5+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z21+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z20)) ...
                +(p0x.*(besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x) ...% f4, E1y
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z04+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z022+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z021) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z05+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z021+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z020)) ...
                +q1y.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z01+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z015+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z014) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z02+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z014+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z013))) ...
                -(l1-l).*(1i./2./x.*(-1i.*d1p.*besselj(l-1,p1.*x)-1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z06+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z019+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z018) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z07+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z018+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z017)) ...
                -q1x.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z01+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z015+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z014) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z02+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z014+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z013)))) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f5, E1y
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z06+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z019+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z018) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z07+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z018+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z017)) ...
                +1i.*q1z.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f6, E1y
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z03+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z016+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z01+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z015+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z014)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z08+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z024+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z023)) ...
                ) ...
                +(-l1) ...% xy part3
                .*( ...
                x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f1, E1y
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z14-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z13) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z14-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z13) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z16-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z15)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z19-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z18) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z16-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z15))) ...
                +1i.*(-x.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f2, E1y
                +0.5.*(-1i.*d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z19-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z18) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16)) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f3, E1y
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16) ...
                +k1z.*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z31-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z21-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z20)) ...
                +(p0x.*(besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x) ...% f4, E1y
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z032-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z022-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z021) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z031-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z021-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z020)) ...
                +q1y.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z015-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z014) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z014-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z013))) ...
                -(l1-l).*(1i./2./x.*(-1i.*d1p.*besselj(l-1,p1.*x)-1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z019-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z018) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z018-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z017)) ...
                -q1x.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z015-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z014) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z014-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z013)))) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f5, E1y
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z019-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z018) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z018-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z017)) ...
                +1i.*q1z.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f6, E1y
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z016-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z015-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z014)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z036-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z024-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z023)) ...
                ) ...
                +(1i./x) ...% xy part4
                .*( ...
                x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f1, E1y
                .*(p1x.*E0y.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z14) ...
                -p1y.*(E0x.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z14) ...
                +q0x.*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                +q0x./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z16)) ...
                -l.*(1i./2./x.^2.*(E01.*(-besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))-E02.*(-besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z19) ...
                +1i.*q0./x.^2.*E0z.*(-((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))+p0.*x.*(((l1-l).*(l1-l-1)./(p0.*x).^2-1).*besselj(l1-l,p0.*x)+besselj(l1-l+1,p0.*x)./(p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                -q0x.*E0y.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z16))) ...
                +(-x.^2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f1-1, E1y
                +0.5.*(-1i.*d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(p1x.*E0y.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z14) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z14) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z16)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z19) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z16))) ...
                +1i.*(-x.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f2, E1y
                +0.5.*(-1i.*d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z19) ...
                +(l1-l).*wce.*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17)) ...
                +1i.*(-1i.*d1p.*((2.*x.^2-2-0.5./x.^2).*besselj(l-1,p1.*x)-(2.*x-0.5./x).*p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))+0.5.*p1.^2.*(((l-1).*(l-2)./(p1.*x).^2-1).*besselj(l-1,p1.*x)+besselj(l,p1.*x)./(p1.*x))) ...% f2-1, E1y
                +1i.*d1m.*((2.*x.^2-2-0.5./x.^2).*besselj(l+1,p1.*x)-(2.*x-0.5./x).*p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))+0.5.*p1.^2.*(((l+1).*(l)./(p1.*x).^2-1).*besselj(l+1,p1.*x)+besselj(l+2,p1.*x)./(p1.*x)))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z19) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17)) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f3, E1y
                .*((1-(l1-l).*wce).*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                +q0z./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(-2.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                +k1z.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z31-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z21)) ...
                +1i.*(-x.^2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f3-1, E1y
                +0.5.*(-1i.*d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                +k1z.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z31-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z21)) ...
                +(p0x.*(p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x)) ...% f4, E1y
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z032-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z022) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z031-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z021)) ...
                +q1y./2.*(-1i.*d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z014))) ...
                -(l1-l).*(1i./2./x.^2.*(-1i.*d1p.*(-besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                -1i.*d1m.*(-besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z018)) ...
                -q1x.*p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z014)))) ...
                +(p0x.*(besselj(l,p1.*x) ...% f4-1, E1y
                .*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z032-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z022) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z031-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z021)) ...
                +q1y.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z014))) ...
                -(l1-l).*(1i./2./x.*(-1i.*d1p.*besselj(l-1,p1.*x)-1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z018)) ...
                -q1x.*besselj(l,p1.*x).*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z014)))) ...
                +0.5i.*(-1i.*d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...% f5, E1y
                +1i.*d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z018)) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f5-1, E1y
                .*(E0z.*(4.*x.*besselj(l1-l,p0.*x)-(4+1./x.^2).*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))+p0.^2./x.*(((l1-l).*(l1-l-1)./(p0.*x).^2-1).*besselj(l1-l,p0.*x)+besselj(l1-l+1,p0.*x)./(p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019) ...
                +(E01.*((2.*x.^2-2-0.5./x.^2).*besselj(l1-l-1,p0.*x)-(2.*x-0.5./x).*p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))+0.5.*p0.^2.*(((l1-l-1).*(l1-l-2)./(p0.*x).^2-1).*besselj(l1-l-1,p0.*x)+besselj(l1-l,p0.*x)./(p0.*x))) ...
                +E02.*((2.*x.^2-2-0.5./x.^2).*besselj(l1-l+1,p0.*x)-(2.*x-0.5./x).*p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))+0.5.*p0.^2.*(((l1-l+1).*(l1-l)./(p0.*x).^2-1).*besselj(l1-l+1,p0.*x)+besselj(l1-l+2,p0.*x)./(p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z018)) ...
                +1i.*q1z./2.*(-1i.*d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...% f6, E1y
                +1i.*d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*(-2.*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z036-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z024)) ...
                +1i.*q1z.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f6-1, E1y
                .*(2.*E0z.*(2.*x.*besselj(l1-l,p0.*x)-p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +(2.*x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                -(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015) ...
                +(-2.*x.*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                +((1-(l1-l).*wce).*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                +q0z./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z036-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z024)) ...
                ) ...
                +1i.*((1+(n-l1).*wce).*cE0z.*besselj(-(n-l1),p0.*x)+q0z.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x))) ...% xy part5
                .*( ...
                (-k1z).*( ...
                x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f1, E1y
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*Zp06 ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*Zp06+q0x.*E0z.*besselj(l1-l,p0.*x).*Zp02+q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Zp01) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)).*Zp05 ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)).*Zp02-q0x.*E0y.*besselj(l1-l,p0.*x).*Zp01)) ...
                +1i.*(-x.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f2, E1y
                +0.5.*(-1i.*d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Zp05 ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*Zp02) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f3, E1y
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*Zp02+k1z.*Zp04) ...
                +(p0x.*(besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x).*Z0p08+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p06) ...% f4, E1y
                +q1y.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*Z0p02+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p01)) ...
                -(l1-l).*(1i./2./x.*(-1i.*d1p.*besselj(l-1,p1.*x)-1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*Z0p07+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p05) ...
                -q1x.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x).*Z0p02+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p01))) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f5, E1y
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))).*Z0p07 ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))).*Z0p05) ...
                +1i.*q1z.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f6, E1y
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*Z0p03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p02) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))).*Z0p04) ...
                ) ...
                ));
            sxy = integral(fxy,0,inf);
            fxz = @(x) exp(-x.^2).*x.*x./2.*(d1m.*besselj(n-1,p1.*x)+d1p.*besselj(n+1,p1.*x)) ...% x
                .*( ...
                px.*cE0y.*besselj(-(n-l1),p0.*x) ...% xz part1
                .*( ...
                besselj(l,p1.*x) ...% f1, E1z
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*Z7 ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*Z7+q0x.*E0z.*besselj(l1-l,p0.*x).*Z6+q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z2) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)).*Z8 ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)).*Z6-q0x.*E0y.*besselj(l1-l,p0.*x).*Z2)) ...
                +1i.*(-2.*besselj(l,p1.*x)+p1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f2, E1z
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z8 ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*Z6) ...
                +1i.*besselj(l,p1.*x) ...% f3, E1z
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*Z6+(w1-l.*wce).*Z5) ...
                +(p0x.*q1y.*besselj(l,p1.*x)-(l1-l).*1i.*q1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f4, E1z
                .*(E0z.*besselj(l1-l,p0.*x).*Z03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z01) ...
                +1i.*l.*wce./w1.*besselj(l,p1.*x) ...% f5, E1z
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))).*Z03 ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))).*Z01) ...
                +1i.*(1-l.*wce./w1).*besselj(l,p1.*x) ...% f6, E1z
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*Z03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z01) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))).*Z08) ...
                ) ...
                +(-py) ...% xz part2
                .*( ...
                besselj(l,p1.*x) ...% f1, E1z
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z7+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z22+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z14) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z7+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z22+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z14) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z6+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z23+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z17) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z8+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z24+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z6+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z23+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z17) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16))) ...
                +1i.*(-2.*besselj(l,p1.*x)+p1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f2, E1z
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z8+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z24+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z6+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z23+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z17)) ...
                +1i.*besselj(l,p1.*x) ...% f3, E1z
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(cE0x.*besselj(-(n-l1),p0.*x).*Z6+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z23+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z17) ...
                +(w1-l.*wce).*(cE0x.*besselj(-(n-l1),p0.*x).*Z5+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z21+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z20)) ...
                +(p0x.*q1y.*besselj(l,p1.*x)-(l1-l).*1i.*q1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f4, E1z
                .*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z03+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z016+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z01+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z015+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z014)) ...
                +1i.*l.*wce./w1.*besselj(l,p1.*x) ...% f5, E1z
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z03+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z016+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z015) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z01+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z015+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z014)) ...
                +1i.*(1-l.*wce./w1).*besselj(l,p1.*x) ...% f6, E1z
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z03+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z016+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z01+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z015+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z014)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z08+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z024+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z023)) ...
                ) ...
                +(-l1) ...% xz part3
                .*( ...
                besselj(l,p1.*x) ...% f1, E1z
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z22-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z14) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z22-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z14) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z23-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z17) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z24-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z19) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z23-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z17) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16))) ...
                +1i.*(-2.*besselj(l,p1.*x)+p1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f2, E1z
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z24-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z19) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z23-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z17)) ...
                +1i.*besselj(l,p1.*x) ...% f3, E1z
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z23-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z17) ...
                +(w1-l.*wce).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z31-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z21-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z20)) ...
                +(p0x.*q1y.*besselj(l,p1.*x)-(l1-l).*1i.*q1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f4, E1z
                .*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z016-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z015-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z014)) ...
                +1i.*l.*wce./w1.*besselj(l,p1.*x) ...% f5, E1z
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z016-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z015) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z015-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z014)) ...
                +1i.*(1-l.*wce./w1).*besselj(l,p1.*x) ...% f6, E1z
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z016-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z015-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z014)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z036-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z024-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z023)) ...
                ) ...
                +(1i./x) ...% xz part4
                .*( ...
                besselj(l,p1.*x) ...% f1, E1z
                .*(p1x.*E0y.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z22) ...
                -p1y.*(E0x.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z22) ...
                +q0x.*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                +q0x./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17)) ...
                -l.*(1i./2./x.^2.*(E01.*(-besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))-E02.*(-besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z24) ...
                +1i.*q0./x.^2.*E0z.*(-((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))+p0.*x.*(((l1-l).*(l1-l-1)./(p0.*x).^2-1).*besselj(l1-l,p0.*x)+besselj(l1-l+1,p0.*x)./(p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                -q0x.*E0y.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17))) ...
                +(-2.*x.*besselj(l,p1.*x)+p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f1-1, E1z
                .*(p1x.*E0y.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z22) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z22) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z24) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17))) ...
                +1i.*(-2.*besselj(l,p1.*x)+p1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f2, E1z
                .*(0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z24) ...
                +(l1-l).*wce.*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23)) ...
                +1i.*(4.*x.*besselj(l,p1.*x) ...% f2-1, E1z
                -(4+1./x.^2).*p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x)) ...
                +p1.^2./x.*((l.*(l-1)./(p1.*x).^2-1).*besselj(l,p1.*x)+besselj(l+1,p1.*x)./(p1.*x))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z24) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23)) ...
                +1i.*besselj(l,p1.*x) ...% f3, E1z
                .*((1-(l1-l).*wce).*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                +q0z./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(-2.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                +(w1-l.*wce).*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z31-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z21)) ...
                +1i.*(-2.*x.*besselj(l,p1.*x)+p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f3-1, E1z
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                +(w1-l.*wce).*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z31-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z21)) ...
                +(p0x.*q1y.*p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x)) ...% f4, E1z
                -(l1-l).*1i.*q1./x.*(-1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))+p1.*((l.*(l-1)./(p1.*x).^2-1).*besselj(l,p1.*x)+besselj(l+1,p1.*x)./(p1.*x)))) ...
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015)) ...
                +(p0x.*q1y.*besselj(l,p1.*x)-(l1-l).*1i.*q1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f4-1, E1z
                .*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015)) ...
                +1i.*l.*wce./w1.*p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x)) ...% f5, E1z
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015)) ...
                +1i.*l.*wce./w1.*besselj(l,p1.*x) ...% f5-1, E1z
                .*(E0z.*(4.*x.*besselj(l1-l,p0.*x)-(4+1./x.^2).*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))+p0.^2./x.*(((l1-l).*(l1-l-1)./(p0.*x).^2-1).*besselj(l1-l,p0.*x)+besselj(l1-l+1,p0.*x)./(p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +(E01.*((2.*x.^2-2-0.5./x.^2).*besselj(l1-l-1,p0.*x)-(2.*x-0.5./x).*p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))+0.5.*p0.^2.*(((l1-l-1).*(l1-l-2)./(p0.*x).^2-1).*besselj(l1-l-1,p0.*x)+besselj(l1-l,p0.*x)./(p0.*x))) ...
                +E02.*((2.*x.^2-2-0.5./x.^2).*besselj(l1-l+1,p0.*x)-(2.*x-0.5./x).*p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))+0.5.*p0.^2.*(((l1-l+1).*(l1-l)./(p0.*x).^2-1).*besselj(l1-l+1,p0.*x)+besselj(l1-l+2,p0.*x)./(p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015)) ...
                +1i.*(1-l.*wce./w1).*p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x)) ...% f6, E1z
                .*(-2.*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z036-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z024)) ...
                +1i.*(1-l.*wce./w1).*besselj(l,p1.*x) ...% f6-1, E1z
                .*(2.*E0z.*(2.*x.*besselj(l1-l,p0.*x)-p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +(2.*x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                -(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015) ...
                +(-2.*x.*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                +((1-(l1-l).*wce).*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                +q0z./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z036-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z024)) ...
                ) ...
                +1i.*((1+(n-l1).*wce).*cE0z.*besselj(-(n-l1),p0.*x)+q0z.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x))) ...% xz part5
                .*( ...
                (-k1z).*( ...
                besselj(l,p1.*x) ...% f1, E1z
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*Zp08 ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*Zp08+q0x.*E0z.*besselj(l1-l,p0.*x).*Zp03+q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Zp02) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)).*Zp07 ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)).*Zp03-q0x.*E0y.*besselj(l1-l,p0.*x).*Zp02)) ...
                +1i.*(-2.*besselj(l,p1.*x)+p1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f2, E1z
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Zp07 ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*Zp03) ...
                +1i.*besselj(l,p1.*x) ...% f3, E1z
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*Zp03+(w1-l.*wce).*Zp04) ...
                +(p0x.*q1y.*besselj(l,p1.*x)-(l1-l).*1i.*q1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f4, E1z
                .*(E0z.*besselj(l1-l,p0.*x).*Z0p03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p02) ...
                +1i.*l.*wce./w1.*besselj(l,p1.*x) ...% f5, E1z
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))).*Z0p03 ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))).*Z0p02) ...
                +1i.*(1-l.*wce./w1).*besselj(l,p1.*x) ...% f6, E1z
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*Z0p03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p02) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))).*Z0p04) ...
                ) ...
                ));
            sxz = integral(fxz,0,inf);
            fyx = @(x) exp(-x.^2).*x.*x./2.*1i.*(d1m.*besselj(n-1,p1.*x)-d1p.*besselj(n+1,p1.*x)) ...% y
                .*( ...
                px.*cE0y.*besselj(-(n-l1),p0.*x) ...% yx part1
                .*( ...
                x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f1, E1x
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*Z1 ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*Z1+q0x.*E0z.*besselj(l1-l,p0.*x).*Z2+q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z3) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)).*Z4 ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)).*Z2-q0x.*E0y.*besselj(l1-l,p0.*x).*Z3)) ...
                +1i.*(-x.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f2, E1x
                +0.5.*(d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z4 ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*Z2) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f3, E1x
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*Z2+k1z.*Z5) ...
                +(p0x.*(q1y.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f4, E1x
                .*(E0z.*besselj(l1-l,p0.*x).*Z01+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z02)) ...
                -(l1-l).*(1i./2./x.*(d1p.*besselj(l-1,p1.*x)-d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*Z06+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z07) ...
                +q1y.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x).*Z01+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z02))) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f5, E1x
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))).*Z06 ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))).*Z07) ...
                +1i.*q1z.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f6, E1x
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*Z03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z01) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))).*Z08) ...
                ) ...
                +(-py) ...% yx part2
                .*( ...
                x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f1, E1x
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z1+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z14+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z13) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z1+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z14+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z13) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z3+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z16+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z15)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z4+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z19+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z3+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z16+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z15))) ...
                +1i.*(-x.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f2, E1x
                +0.5.*(d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z4+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z19+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16)) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f3, E1x
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16) ...
                +k1z.*(cE0x.*besselj(-(n-l1),p0.*x).*Z5+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z21+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z20)) ...
                +(p0x.*(q1y.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f4, E1x
                .*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z01+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z015+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z014) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z02+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z014+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z013))) ...
                -(l1-l).*(1i./2./x.*(d1p.*besselj(l-1,p1.*x)-d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z06+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z019+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z018) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z07+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z018+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z017)) ...
                +q1y.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z01+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z015+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z014) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z02+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z014+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z013)))) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f5, E1x
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z06+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z019+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z018) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z07+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z018+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z017)) ...
                +1i.*q1z.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f6, E1x
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z03+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z016+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z01+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z015+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z014)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z08+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z024+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z023)) ...
                ) ...
                +(-l1) ...% yx part3
                .*( ...
                x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f1, E1x
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z14-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z13) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z14-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z13) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z16-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z15)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z19-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z18) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z16-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z15))) ...
                +1i.*(-x.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f2, E1x
                +0.5.*(d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z19-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z18) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16)) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f3, E1x
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16) ...
                +k1z.*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z31-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z21-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z20)) ...
                +(p0x.*(q1y.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f4, E1x
                .*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z015-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z014) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z014-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z013))) ...
                -(l1-l).*(1i./2./x.*(d1p.*besselj(l-1,p1.*x)-d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z019-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z018) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z018-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z017)) ...
                +q1y.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z015-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z014) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z014-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z013)))) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f5, E1x
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z019-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z018) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z018-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z017)) ...
                +1i.*q1z.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f6, E1x
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z016-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z015-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z014)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z036-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z024-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z023)) ...
                ) ...
                +(1i./x) ...% yx part4
                .*( ...
                x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f1, E1x
                .*(p1x.*E0y.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z14) ...
                -p1y.*(E0x.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z14) ...
                +q0x.*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                +q0x./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z16)) ...
                -l.*(1i./2./x.^2.*(E01.*(-besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))-E02.*(-besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z19) ...
                +1i.*q0./x.^2.*E0z.*(-((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))+p0.*x.*(((l1-l).*(l1-l-1)./(p0.*x).^2-1).*besselj(l1-l,p0.*x)+besselj(l1-l+1,p0.*x)./(p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                -q0x.*E0y.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z16))) ...
                +(-x.^2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f1-1, E1x
                +0.5.*(d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(p1x.*E0y.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z14) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z14) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z16)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z19) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z16))) ...
                +1i.*(-x.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f2, E1x
                +0.5.*(d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z19) ...
                +(l1-l).*wce.*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17)) ...
                +1i.*(d1p.*((2.*x.^2-2-0.5./x.^2).*besselj(l-1,p1.*x)-(2.*x-0.5./x).*p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))+0.5.*p1.^2.*(((l-1).*(l-2)./(p1.*x).^2-1).*besselj(l-1,p1.*x)+besselj(l,p1.*x)./(p1.*x))) ...% f2-1, E1x
                +d1m.*((2.*x.^2-2-0.5./x.^2).*besselj(l+1,p1.*x)-(2.*x-0.5./x).*p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))+0.5.*p1.^2.*(((l+1).*(l)./(p1.*x).^2-1).*besselj(l+1,p1.*x)+besselj(l+2,p1.*x)./(p1.*x)))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z19) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17)) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f3, E1x
                .*((1-(l1-l).*wce).*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                +q0z./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(-2.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                +k1z.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z31-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z21)) ...
                +1i.*(-x.^2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f3-1, E1x
                +0.5.*(d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                +k1z.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z31-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z21)) ...
                +(p0x.*(q1y./2.*(d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...% f4, E1x
                +d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z014))) ...
                -(l1-l).*(1i./2./x.^2.*(d1p.*(-besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                -d1m.*(-besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z018)) ...
                +q1y.*p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z014)))) ...
                +(p0x.*(q1y.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f4-1, E1x
                .*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z014))) ...
                -(l1-l).*(1i./2./x.*(d1p.*besselj(l-1,p1.*x)-d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z018)) ...
                +q1y.*besselj(l,p1.*x).*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z014)))) ...
                +0.5i.*(d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...% f5, E1x
                +d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z018)) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f5-1, E1x
                .*(E0z.*(4.*x.*besselj(l1-l,p0.*x)-(4+1./x.^2).*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))+p0.^2./x.*(((l1-l).*(l1-l-1)./(p0.*x).^2-1).*besselj(l1-l,p0.*x)+besselj(l1-l+1,p0.*x)./(p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019) ...
                +(E01.*((2.*x.^2-2-0.5./x.^2).*besselj(l1-l-1,p0.*x)-(2.*x-0.5./x).*p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))+0.5.*p0.^2.*(((l1-l-1).*(l1-l-2)./(p0.*x).^2-1).*besselj(l1-l-1,p0.*x)+besselj(l1-l,p0.*x)./(p0.*x))) ...
                +E02.*((2.*x.^2-2-0.5./x.^2).*besselj(l1-l+1,p0.*x)-(2.*x-0.5./x).*p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))+0.5.*p0.^2.*(((l1-l+1).*(l1-l)./(p0.*x).^2-1).*besselj(l1-l+1,p0.*x)+besselj(l1-l+2,p0.*x)./(p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z018)) ...
                +1i.*q1z./2.*(d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...% f6, E1x
                +d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*(-2.*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z036-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z024)) ...
                +1i.*q1z.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f6-1, E1x
                .*(2.*E0z.*(2.*x.*besselj(l1-l,p0.*x)-p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +(2.*x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                -(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015) ...
                +(-2.*x.*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                +((1-(l1-l).*wce).*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                +q0z./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z036-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z024)) ...
                ) ...
                +1i.*((1+(n-l1).*wce).*cE0z.*besselj(-(n-l1),p0.*x)+q0z.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x))) ...% yx part5
                .*( ...
                (-k1z).*( ...
                x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f1, E1x
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*Zp06 ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*Zp06+q0x.*E0z.*besselj(l1-l,p0.*x).*Zp02+q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Zp01) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)).*Zp05 ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)).*Zp02-q0x.*E0y.*besselj(l1-l,p0.*x).*Zp01)) ...
                +1i.*(-x.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f2, E1x
                +0.5.*(d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Zp05 ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*Zp02) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f3, E1x
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*Zp02+k1z.*Zp04) ...
                +(p0x.*(q1y.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f4, E1x
                .*(E0z.*besselj(l1-l,p0.*x).*Z0p02+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p01)) ...
                -(l1-l).*(1i./2./x.*(d1p.*besselj(l-1,p1.*x)-d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*Z0p07+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p05) ...
                +q1y.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x).*Z0p02+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p01))) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f5, E1x
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))).*Z0p07 ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))).*Z0p05) ...
                +1i.*q1z.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f6, E1x
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*Z0p03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p02) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))).*Z0p04) ...
                ) ...
                ));
            syx = integral(fyx,0,inf);
            fyy = @(x) exp(-x.^2).*x.*x./2.*1i.*(d1m.*besselj(n-1,p1.*x)-d1p.*besselj(n+1,p1.*x)) ...% y
                .*( ...
                px.*cE0y.*besselj(-(n-l1),p0.*x) ...% yy part1
                .*( ...
                x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f1, E1y
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*Z1 ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*Z1+q0x.*E0z.*besselj(l1-l,p0.*x).*Z2+q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z3) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)).*Z4 ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)).*Z2-q0x.*E0y.*besselj(l1-l,p0.*x).*Z3)) ...
                +1i.*(-x.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f2, E1y
                +0.5.*(-1i.*d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z4 ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*Z2) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f3, E1y
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*Z2+k1z.*Z5) ...
                +(p0x.*(besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x).*Z04+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z05) ...% f4, E1y
                +q1y.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*Z01+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z02)) ...
                -(l1-l).*(1i./2./x.*(-1i.*d1p.*besselj(l-1,p1.*x)-1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*Z06+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z07) ...
                -q1x.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x).*Z01+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z02))) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f5, E1y
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))).*Z06 ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))).*Z07) ...
                +1i.*q1z.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f6, E1y
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*Z03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z01) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))).*Z08) ...
                ) ...
                +(-py) ...% yy part2
                .*( ...
                x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f1, E1y
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z1+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z14+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z13) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z1+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z14+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z13) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z3+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z16+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z15)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z4+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z19+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z3+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z16+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z15))) ...
                +1i.*(-x.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f2, E1y
                +0.5.*(-1i.*d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z4+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z19+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16)) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f3, E1y
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16) ...
                +k1z.*(cE0x.*besselj(-(n-l1),p0.*x).*Z5+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z21+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z20)) ...
                +(p0x.*(besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x) ...% f4, E1y
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z04+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z022+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z021) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z05+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z021+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z020)) ...
                +q1y.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z01+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z015+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z014) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z02+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z014+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z013))) ...
                -(l1-l).*(1i./2./x.*(-1i.*d1p.*besselj(l-1,p1.*x)-1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z06+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z019+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z018) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z07+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z018+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z017)) ...
                -q1x.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z01+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z015+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z014) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z02+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z014+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z013)))) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f5, E1y
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z06+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z019+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z018) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z07+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z018+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z017)) ...
                +1i.*q1z.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f6, E1y
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z03+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z016+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z01+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z015+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z014)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z08+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z024+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z023)) ...
                ) ...
                +(-l1) ...% yy part3
                .*( ...
                x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f1, E1y
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z14-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z13) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z14-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z13) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z16-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z15)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z19-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z18) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z16-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z15))) ...
                +1i.*(-x.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f2, E1y
                +0.5.*(-1i.*d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z19-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z18) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16)) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f3, E1y
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16) ...
                +k1z.*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z31-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z21-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z20)) ...
                +(p0x.*(besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x) ...% f4, E1y
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z032-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z022-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z021) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z031-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z021-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z020)) ...
                +q1y.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z015-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z014) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z014-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z013))) ...
                -(l1-l).*(1i./2./x.*(-1i.*d1p.*besselj(l-1,p1.*x)-1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z019-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z018) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z018-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z017)) ...
                -q1x.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z015-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z014) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z014-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z013)))) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f5, E1y
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z019-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z018) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z018-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z017)) ...
                +1i.*q1z.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f6, E1y
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z016-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z015-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z014)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z036-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z024-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z023)) ...
                ) ...
                +(1i./x) ...% yy part4
                .*( ...
                x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f1, E1y
                .*(p1x.*E0y.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z14) ...
                -p1y.*(E0x.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z14) ...
                +q0x.*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                +q0x./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z16)) ...
                -l.*(1i./2./x.^2.*(E01.*(-besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))-E02.*(-besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z19) ...
                +1i.*q0./x.^2.*E0z.*(-((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))+p0.*x.*(((l1-l).*(l1-l-1)./(p0.*x).^2-1).*besselj(l1-l,p0.*x)+besselj(l1-l+1,p0.*x)./(p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                -q0x.*E0y.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z16))) ...
                +(-x.^2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f1-1, E1y
                +0.5.*(-1i.*d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(p1x.*E0y.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z14) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z29-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z14) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z16)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z19) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z18-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z16))) ...
                +1i.*(-x.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f2, E1y
                +0.5.*(-1i.*d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z19) ...
                +(l1-l).*wce.*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17)) ...
                +1i.*(-1i.*d1p.*((2.*x.^2-2-0.5./x.^2).*besselj(l-1,p1.*x)-(2.*x-0.5./x).*p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))+0.5.*p1.^2.*(((l-1).*(l-2)./(p1.*x).^2-1).*besselj(l-1,p1.*x)+besselj(l,p1.*x)./(p1.*x))) ...% f2-1, E1y
                +1i.*d1m.*((2.*x.^2-2-0.5./x.^2).*besselj(l+1,p1.*x)-(2.*x-0.5./x).*p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))+0.5.*p1.^2.*(((l+1).*(l)./(p1.*x).^2-1).*besselj(l+1,p1.*x)+besselj(l+2,p1.*x)./(p1.*x)))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z30-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z19) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17)) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f3, E1y
                .*((1-(l1-l).*wce).*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                +q0z./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(-2.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                +k1z.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z31-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z21)) ...
                +1i.*(-x.^2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f3-1, E1y
                +0.5.*(-1i.*d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17) ...
                +k1z.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z31-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z21)) ...
                +(p0x.*(p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x)) ...% f4, E1y
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z032-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z022) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z031-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z021)) ...
                +q1y./2.*(-1i.*d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z014))) ...
                -(l1-l).*(1i./2./x.^2.*(-1i.*d1p.*(-besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                -1i.*d1m.*(-besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z018)) ...
                -q1x.*p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z014)))) ...
                +(p0x.*(besselj(l,p1.*x) ...% f4-1, E1y
                .*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z032-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z022) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z031-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z021)) ...
                +q1y.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z014))) ...
                -(l1-l).*(1i./2./x.*(-1i.*d1p.*besselj(l-1,p1.*x)-1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z018)) ...
                -q1x.*besselj(l,p1.*x).*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z029-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z014)))) ...
                +0.5i.*(-1i.*d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...% f5, E1y
                +1i.*d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z018)) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f5-1, E1y
                .*(E0z.*(4.*x.*besselj(l1-l,p0.*x)-(4+1./x.^2).*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))+p0.^2./x.*(((l1-l).*(l1-l-1)./(p0.*x).^2-1).*besselj(l1-l,p0.*x)+besselj(l1-l+1,p0.*x)./(p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019) ...
                +(E01.*((2.*x.^2-2-0.5./x.^2).*besselj(l1-l-1,p0.*x)-(2.*x-0.5./x).*p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))+0.5.*p0.^2.*(((l1-l-1).*(l1-l-2)./(p0.*x).^2-1).*besselj(l1-l-1,p0.*x)+besselj(l1-l,p0.*x)./(p0.*x))) ...
                +E02.*((2.*x.^2-2-0.5./x.^2).*besselj(l1-l+1,p0.*x)-(2.*x-0.5./x).*p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))+0.5.*p0.^2.*(((l1-l+1).*(l1-l)./(p0.*x).^2-1).*besselj(l1-l+1,p0.*x)+besselj(l1-l+2,p0.*x)./(p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z033-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z018)) ...
                +1i.*q1z./2.*(-1i.*d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...% f6, E1y
                +1i.*d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*(-2.*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z036-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z024)) ...
                +1i.*q1z.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f6-1, E1y
                .*(2.*E0z.*(2.*x.*besselj(l1-l,p0.*x)-p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +(2.*x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                -(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015) ...
                +(-2.*x.*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                +((1-(l1-l).*wce).*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                +q0z./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z036-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z024)) ...
                ) ...
                +1i.*((1+(n-l1).*wce).*cE0z.*besselj(-(n-l1),p0.*x)+q0z.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x))) ...% yy part5
                .*( ...
                (-k1z).*( ...
                x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f1, E1y
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*Zp06 ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*Zp06+q0x.*E0z.*besselj(l1-l,p0.*x).*Zp02+q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Zp01) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)).*Zp05 ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)).*Zp02-q0x.*E0y.*besselj(l1-l,p0.*x).*Zp01)) ...
                +1i.*(-x.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f2, E1y
                +0.5.*(-1i.*d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Zp05 ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*Zp02) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f3, E1y
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*Zp02+k1z.*Zp04) ...
                +(p0x.*(besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x).*Z0p08+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p06) ...% f4, E1y
                +q1y.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*Z0p02+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p01)) ...
                -(l1-l).*(1i./2./x.*(-1i.*d1p.*besselj(l-1,p1.*x)-1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*Z0p07+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p05) ...
                -q1x.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x).*Z0p02+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p01))) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f5, E1y
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))).*Z0p07 ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))).*Z0p05) ...
                +1i.*q1z.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f6, E1y
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*Z0p03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p02) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))).*Z0p04) ...
                ) ...
                ));
            syy = integral(fyy,0,inf);
            fyz = @(x) exp(-x.^2).*x.*x./2.*1i.*(d1m.*besselj(n-1,p1.*x)-d1p.*besselj(n+1,p1.*x)) ...% y
                .*( ...
                px.*cE0y.*besselj(-(n-l1),p0.*x) ...% yz part1
                .*( ...
                besselj(l,p1.*x) ...% f1, E1z
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*Z7 ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*Z7+q0x.*E0z.*besselj(l1-l,p0.*x).*Z6+q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z2) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)).*Z8 ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)).*Z6-q0x.*E0y.*besselj(l1-l,p0.*x).*Z2)) ...
                +1i.*(-2.*besselj(l,p1.*x)+p1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f2, E1z
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z8 ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*Z6) ...
                +1i.*besselj(l,p1.*x) ...% f3, E1z
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*Z6+(w1-l.*wce).*Z5) ...
                +(p0x.*q1y.*besselj(l,p1.*x)-(l1-l).*1i.*q1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...%f4, E1z
                .*(E0z.*besselj(l1-l,p0.*x).*Z03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z01) ...
                +1i.*l.*wce./w1.*besselj(l,p1.*x) ...% f5, E1z
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))).*Z03 ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))).*Z01) ...
                +1i.*(1-l.*wce./w1).*besselj(l,p1.*x) ...% f6, E1z
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*Z03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z01) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))).*Z08) ...
                ) ...
                +(-py) ...% yz part2
                .*( ...
                besselj(l,p1.*x) ...% f1, E1z
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z7+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z22+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z14) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z7+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z22+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z14) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z6+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z23+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z17) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z8+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z24+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z6+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z23+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z17) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16))) ...
                +1i.*(-2.*besselj(l,p1.*x)+p1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f2, E1z
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z8+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z24+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z6+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z23+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z17)) ...
                +1i.*besselj(l,p1.*x) ...% f3, E1z
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(cE0x.*besselj(-(n-l1),p0.*x).*Z6+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z23+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z17) ...
                +(w1-l.*wce).*(cE0x.*besselj(-(n-l1),p0.*x).*Z5+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z21+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z20)) ...
                +(p0x.*q1y.*besselj(l,p1.*x)-(l1-l).*1i.*q1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f4, E1z
                .*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z03+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z016+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z01+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z015+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z014)) ...
                +1i.*l.*wce./w1.*besselj(l,p1.*x) ...% f5, E1z
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z03+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z016+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z015) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z01+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z015+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z014)) ...
                +1i.*(1-l.*wce./w1).*besselj(l,p1.*x) ...% f6, E1z
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z03+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z016+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z01+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z015+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z014)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z08+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z024+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z023)) ...
                ) ...
                +(-l1) ...% yz part3
                .*( ...
                besselj(l,p1.*x) ...% f1, E1z
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z22-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z14) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z22-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z14) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z23-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z17) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z24-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z19) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z23-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z17) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16))) ...
                +1i.*(-2.*besselj(l,p1.*x)+p1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f2, E1z
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z24-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z19) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z23-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z17)) ...
                +1i.*besselj(l,p1.*x) ...% f3, E1z
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z23-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z17) ...
                +(w1-l.*wce).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z31-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z21-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z20)) ...
                +(p0x.*q1y.*besselj(l,p1.*x)-(l1-l).*1i.*q1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f4, E1z
                .*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z016-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z015-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z014)) ...
                +1i.*l.*wce./w1.*besselj(l,p1.*x) ...% f5, E1z
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z016-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z015) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z015-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z014)) ...
                +1i.*(1-l.*wce./w1).*besselj(l,p1.*x) ...% f6, E1z
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z016-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z015-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z014)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z036-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z024-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z023)) ...
                ) ...
                +(1i./x) ...% yz part4
                .*( ...
                besselj(l,p1.*x) ...% f1, E1z
                .*(p1x.*E0y.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z22) ...
                -p1y.*(E0x.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z22) ...
                +q0x.*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                +q0x./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17)) ...
                -l.*(1i./2./x.^2.*(E01.*(-besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))-E02.*(-besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z24) ...
                +1i.*q0./x.^2.*E0z.*(-((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))+p0.*x.*(((l1-l).*(l1-l-1)./(p0.*x).^2-1).*besselj(l1-l,p0.*x)+besselj(l1-l+1,p0.*x)./(p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                -q0x.*E0y.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17))) ...
                +(-2.*x.*besselj(l,p1.*x)+p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f1-1, E1z
                .*(p1x.*E0y.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z22) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z22) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z24) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17))) ...
                +1i.*(-2.*besselj(l,p1.*x)+p1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f2, E1z
                .*(0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z24) ...
                +(l1-l).*wce.*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23)) ...
                +1i.*(4.*x.*besselj(l,p1.*x) ...% f2-1, E1z
                -(4+1./x.^2).*p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x)) ...
                +p1.^2./x.*((l.*(l-1)./(p1.*x).^2-1).*besselj(l,p1.*x)+besselj(l+1,p1.*x)./(p1.*x))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z24) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23)) ...
                +1i.*besselj(l,p1.*x) ...% f3, E1z
                .*((1-(l1-l).*wce).*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                +q0z./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(-2.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                +(w1-l.*wce).*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z31-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z21)) ...
                +1i.*(-2.*x.*besselj(l,p1.*x)+p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f3-1, E1z
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                +(w1-l.*wce).*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z31-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z21)) ...
                +(p0x.*q1y.*p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x)) ...% f4, E1z
                -(l1-l).*1i.*q1./x.*(-1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))+p1.*((l.*(l-1)./(p1.*x).^2-1).*besselj(l,p1.*x)+besselj(l+1,p1.*x)./(p1.*x)))) ...
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015)) ...
                +(p0x.*q1y.*besselj(l,p1.*x)-(l1-l).*1i.*q1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f4-1, E1z
                .*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015)) ...
                +1i.*l.*wce./w1.*p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x)) ...% f5, E1z
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015)) ...
                +1i.*l.*wce./w1.*besselj(l,p1.*x) ...% f5-1, E1z
                .*(E0z.*(4.*x.*besselj(l1-l,p0.*x)-(4+1./x.^2).*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))+p0.^2./x.*(((l1-l).*(l1-l-1)./(p0.*x).^2-1).*besselj(l1-l,p0.*x)+besselj(l1-l+1,p0.*x)./(p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +(E01.*((2.*x.^2-2-0.5./x.^2).*besselj(l1-l-1,p0.*x)-(2.*x-0.5./x).*p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))+0.5.*p0.^2.*(((l1-l-1).*(l1-l-2)./(p0.*x).^2-1).*besselj(l1-l-1,p0.*x)+besselj(l1-l,p0.*x)./(p0.*x))) ...
                +E02.*((2.*x.^2-2-0.5./x.^2).*besselj(l1-l+1,p0.*x)-(2.*x-0.5./x).*p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))+0.5.*p0.^2.*(((l1-l+1).*(l1-l)./(p0.*x).^2-1).*besselj(l1-l+1,p0.*x)+besselj(l1-l+2,p0.*x)./(p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015)) ...
                +1i.*(1-l.*wce./w1).*p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x)) ...% f6, E1z
                .*(-2.*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z036-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z024)) ...
                +1i.*(1-l.*wce./w1).*besselj(l,p1.*x) ...% f6-1, E1z
                .*(2.*E0z.*(2.*x.*besselj(l1-l,p0.*x)-p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +(2.*x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                -(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015) ...
                +(-2.*x.*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                +((1-(l1-l).*wce).*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                +q0z./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z036-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z024)) ...
                ) ...
                +1i.*((1+(n-l1).*wce).*cE0z.*besselj(-(n-l1),p0.*x)+q0z.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x))) ...% yz part5
                .*( ...
                (-k1z).*( ...
                besselj(l,p1.*x) ...% f1, E1z
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*Zp08 ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*Zp08+q0x.*E0z.*besselj(l1-l,p0.*x).*Zp03+q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Zp02) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)).*Zp07 ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)).*Zp03-q0x.*E0y.*besselj(l1-l,p0.*x).*Zp02)) ...
                +1i.*(-2.*besselj(l,p1.*x)+p1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f2, E1z
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Zp07 ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*Zp03) ...
                +1i.*besselj(l,p1.*x) ...% f3, E1z
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*Zp03+(w1-l.*wce).*Zp04) ...
                +(p0x.*q1y.*besselj(l,p1.*x)-(l1-l).*1i.*q1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f4, E1z
                .*(E0z.*besselj(l1-l,p0.*x).*Z0p03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p02) ...
                +1i.*l.*wce./w1.*besselj(l,p1.*x) ...% f5, E1z
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))).*Z0p03 ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))).*Z0p02) ...
                +1i.*(1-l.*wce./w1).*besselj(l,p1.*x) ...% f6, E1z
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*Z0p03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p02) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))).*Z0p04) ...
                ) ...
                ));
            syz = integral(fyz,0,inf);
            fzx = @(x) exp(-x.^2).*x.*besselj(n,p1.*x) ...% z
                .*( ...
                px.*cE0y.*besselj(-(n-l1),p0.*x) ...% zx part1
                .*( ...
                x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f1, E1x
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*Z7 ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*Z7+q0x.*E0z.*besselj(l1-l,p0.*x).*Z6+q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z2) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)).*Z8 ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)).*Z6-q0x.*E0y.*besselj(l1-l,p0.*x).*Z2)) ...
                +1i.*(-x.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f2, E1x
                +0.5.*(d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z8 ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*Z6) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f3, E1x
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*Z6+k1z.*Z9) ...
                +(p0x.*(q1y.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f4, E1x
                .*(E0z.*besselj(l1-l,p0.*x).*Z03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z01)) ...
                -(l1-l).*(1i./2./x.*(d1p.*besselj(l-1,p1.*x)-d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*Z011+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z06) ...
                +q1y.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x).*Z03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z01))) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f5, E1x
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))).*Z011 ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))).*Z06) ...
                +1i.*q1z.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f6, E1x
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*Z09+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z03) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))).*Z012) ...
                ) ...
                +(-py) ...% zx part2
                .*( ...
                x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f1, E1x
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z7+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z22+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z14) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z7+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z22+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z14) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z6+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z23+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z17) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z8+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z24+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z6+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z23+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z17) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16))) ...
                +1i.*(-x.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f2, E1x
                +0.5.*(d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z8+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z24+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z6+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z23+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z17)) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f3, E1x
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(cE0x.*besselj(-(n-l1),p0.*x).*Z6+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z23+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z17) ...
                +k1z.*(cE0x.*besselj(-(n-l1),p0.*x).*Z9+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z25+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z21)) ...
                +(p0x.*(q1y.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f4, E1x
                .*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z03+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z016+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z01+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z015+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z014))) ...
                -(l1-l).*(1i./2./x.*(d1p.*besselj(l-1,p1.*x)-d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z011+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z026+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z019) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z06+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z019+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z018)) ...
                +q1y.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z03+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z016+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z01+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z015+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z014)))) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f5, E1x
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z011+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z026+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z019) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z06+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z019+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z018)) ...
                +1i.*q1z.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f6, E1x
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z09+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z025+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z016) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z03+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z016+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z015)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z012+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z028+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z024)) ...
                ) ...
                +(-l1) ...% zx part3
                .*( ...
                x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f1, E1x
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z22-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z14) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z22-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z14) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z23-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z17) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z24-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z19) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z23-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z17) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16))) ...
                +1i.*(-x.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f2, E1x
                +0.5.*(d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z24-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z19) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z23-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z17)) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f3, E1x
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z23-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z17) ...
                +k1z.*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z34-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z25-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z21)) ...
                +(p0x.*(q1y.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f4, E1x
                .*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z016-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z015-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z014))) ...
                -(l1-l).*(1i./2./x.*(d1p.*besselj(l-1,p1.*x)-d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z038-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z026-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z019) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z019-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z018)) ...
                +q1y.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z016-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z015-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z014)))) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f5, E1x
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z038-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z026-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z019) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z019-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z018)) ...
                +1i.*q1z.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f6, E1x
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z039-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z025-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z016) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z016-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z015)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z040-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z028-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z024)) ...
                ) ...
                +(1i./x) ...% zx part4
                .*( ...
                x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f1, E1x
                .*(p1x.*E0y.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z22) ...
                -p1y.*(E0x.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z22) ...
                +q0x.*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                +q0x./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17)) ...
                -l.*(1i./2./x.^2.*(E01.*(-besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))-E02.*(-besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z24) ...
                +1i.*q0./x.^2.*E0z.*(-((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))+p0.*x.*(((l1-l).*(l1-l-1)./(p0.*x).^2-1).*besselj(l1-l,p0.*x)+besselj(l1-l+1,p0.*x)./(p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                -q0x.*E0y.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17))) ...
                +(-x.^2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f1-1, E1x
                +0.5.*(d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(p1x.*E0y.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z22) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z22) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z24) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17))) ...
                +1i.*(-x.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f2, E1x
                +0.5.*(d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z24) ...
                +(l1-l).*wce.*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23)) ...
                +1i.*(d1p.*((2.*x.^2-2-0.5./x.^2).*besselj(l-1,p1.*x)-(2.*x-0.5./x).*p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))+0.5.*p1.^2.*(((l-1).*(l-2)./(p1.*x).^2-1).*besselj(l-1,p1.*x)+besselj(l,p1.*x)./(p1.*x))) ...% f2-1, E1x
                +d1m.*((2.*x.^2-2-0.5./x.^2).*besselj(l+1,p1.*x)-(2.*x-0.5./x).*p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))+0.5.*p1.^2.*(((l+1).*(l)./(p1.*x).^2-1).*besselj(l+1,p1.*x)+besselj(l+2,p1.*x)./(p1.*x)))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z24) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23)) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f3, E1x
                .*((1-(l1-l).*wce).*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                +q0z./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(-2.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                +k1z.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z34-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z25)) ...
                +1i.*(-x.^2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f3-1, E1x
                +0.5.*(d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                +k1z.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z34-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z25)) ...
                +(p0x.*(q1y./2.*(d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...% f4, E1x
                +d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015))) ...
                -(l1-l).*(1i./2./x.^2.*(d1p.*(-besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                -d1m.*(-besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z038-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z026) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019)) ...
                +q1y.*p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015)))) ...
                +(p0x.*(q1y.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f4-1, E1x
                .*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015))) ...
                -(l1-l).*(1i./2./x.*(d1p.*besselj(l-1,p1.*x)-d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z038-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z026) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019)) ...
                +q1y.*besselj(l,p1.*x).*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015)))) ...
                +0.5i.*(d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...% f5, E1x
                +d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z038-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z026) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019)) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f5-1, E1x
                .*(E0z.*(4.*x.*besselj(l1-l,p0.*x)-(4+1./x.^2).*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))+p0.^2./x.*(((l1-l).*(l1-l-1)./(p0.*x).^2-1).*besselj(l1-l,p0.*x)+besselj(l1-l+1,p0.*x)./(p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z038-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z026) ...
                +(E01.*((2.*x.^2-2-0.5./x.^2).*besselj(l1-l-1,p0.*x)-(2.*x-0.5./x).*p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))+0.5.*p0.^2.*(((l1-l-1).*(l1-l-2)./(p0.*x).^2-1).*besselj(l1-l-1,p0.*x)+besselj(l1-l,p0.*x)./(p0.*x))) ...
                +E02.*((2.*x.^2-2-0.5./x.^2).*besselj(l1-l+1,p0.*x)-(2.*x-0.5./x).*p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))+0.5.*p0.^2.*(((l1-l+1).*(l1-l)./(p0.*x).^2-1).*besselj(l1-l+1,p0.*x)+besselj(l1-l+2,p0.*x)./(p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019)) ...
                +1i.*q1z./2.*(d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...% f6, E1x
                +d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*(-2.*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z039-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z025) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z040-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z028)) ...
                +1i.*q1z.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f6-1, E1x
                .*(2.*E0z.*(2.*x.*besselj(l1-l,p0.*x)-p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z039-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z025) ...
                +(2.*x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                -(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +(-2.*x.*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                +((1-(l1-l).*wce).*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                +q0z./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z040-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z028)) ...
                ) ...
                +1i.*((1+(n-l1).*wce).*cE0z.*besselj(-(n-l1),p0.*x)+q0z.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x))) ...% zx part5
                .*( ...
                zn1.*(-k1z).*( ...
                x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f1, E1x
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*Zp06 ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*Zp06+q0x.*E0z.*besselj(l1-l,p0.*x).*Zp02+q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Zp01) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)).*Zp05 ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)).*Zp02-q0x.*E0y.*besselj(l1-l,p0.*x).*Zp01)) ...
                +1i.*(-x.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f2, E1x
                +0.5.*(d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Zp05 ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*Zp02) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f3, E1x
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*Zp02+k1z.*Zp04) ...
                +(p0x.*(q1y.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f4, E1x
                .*(E0z.*besselj(l1-l,p0.*x).*Z0p02+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p01)) ...
                -(l1-l).*(1i./2./x.*(d1p.*besselj(l-1,p1.*x)-d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*Z0p07+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p05) ...
                +q1y.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x).*Z0p02+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p01))) ...
                +1i.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f5, E1x
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))).*Z0p07 ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))).*Z0p05) ...
                +1i.*q1z.*x./2.*(d1p.*besselj(l-1,p1.*x)+d1m.*besselj(l+1,p1.*x)) ...% f6, E1x
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*Z0p03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p02) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))).*Z0p04) ...
                ) ...
                ));
            szx = integral(fzx,0,inf);
            fzy = @(x) exp(-x.^2).*x.*besselj(n,p1.*x) ...% z
                .*( ...
                px.*cE0y.*besselj(-(n-l1),p0.*x) ...% zy part1
                .*( ...
                x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f1, E1y
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*Z7 ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*Z7+q0x.*E0z.*besselj(l1-l,p0.*x).*Z6+q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z2) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)).*Z8 ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)).*Z6-q0x.*E0y.*besselj(l1-l,p0.*x).*Z2)) ...
                +1i.*(-x.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f2, E1y
                +0.5.*(-1i.*d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z8 ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*Z6) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f3, E1y
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*Z6+k1z.*Z9) ...
                +(p0x.*(besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x).*Z010+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z04) ...% f4, E1y
                +q1y.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*Z03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z01)) ...
                -(l1-l).*(1i./2./x.*(-1i.*d1p.*besselj(l-1,p1.*x)-1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*Z011+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z06) ...
                -q1x.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x).*Z03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z01))) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f5, E1y
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))).*Z011 ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))).*Z06) ...
                +1i.*q1z.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f6, E1y
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*Z09+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z03) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))).*Z012) ...
                ) ...
                +(-py) ...% zy part2
                .*( ...
                x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f1, E1y
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z7+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z22+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z14) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z7+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z22+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z14) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z6+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z23+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z17) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z8+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z24+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z6+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z23+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z17) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z2+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z17+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z16))) ...
                +1i.*(-x.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f2, E1y
                +0.5.*(-1i.*d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z8+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z24+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z6+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z23+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z17)) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f3, E1y
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(cE0x.*besselj(-(n-l1),p0.*x).*Z6+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z23+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z17) ...
                +k1z.*(cE0x.*besselj(-(n-l1),p0.*x).*Z9+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z25+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z21)) ...
                +(p0x.*(besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x) ...% f4, E1y
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z010+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z027+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z022) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z04+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z022+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z021)) ...
                +q1y.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z03+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z016+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z01+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z015+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z014))) ...
                -(l1-l).*(1i./2./x.*(-1i.*d1p.*besselj(l-1,p1.*x)-1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z011+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z026+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z019) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z06+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z019+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z018)) ...
                -q1x.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z03+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z016+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z01+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z015+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z014)))) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f5, E1y
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z011+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z026+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z019) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z06+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z019+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z018)) ...
                +1i.*q1z.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f6, E1y
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z09+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z025+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z016) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z03+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z016+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z015)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z012+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z028+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z024)) ...
                ) ...
                +(-l1) ...% zy part3
                .*( ...
                x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f1, E1y
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z22-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z14) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z22-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z14) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z23-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z17) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z24-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z19) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z23-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z17) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z17-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z16))) ...
                +1i.*(-x.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f2, E1y
                +0.5.*(-1i.*d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z24-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z19) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z23-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z17)) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f3, E1y
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z23-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z17) ...
                +k1z.*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z34-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z25-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z21)) ...
                +(p0x.*(besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x) ...% f4, E1y
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z037-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z027-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z022) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z032-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z022-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z021)) ...
                +q1y.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z016-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z015-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z014))) ...
                -(l1-l).*(1i./2./x.*(-1i.*d1p.*besselj(l-1,p1.*x)-1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z038-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z026-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z019) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z019-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z018)) ...
                -q1x.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z016-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z015) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z015-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z014)))) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f5, E1y
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z038-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z026-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z019) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z019-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z018)) ...
                +1i.*q1z.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f6, E1y
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z039-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z025-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z016) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z016-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z015)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z040-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z028-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z024)) ...
                ) ...
                +(1i./x) ...% zy part4
                .*( ...
                x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f1, E1y
                .*(p1x.*E0y.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z22) ...
                -p1y.*(E0x.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z22) ...
                +q0x.*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                +q0x./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17)) ...
                -l.*(1i./2./x.^2.*(E01.*(-besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))-E02.*(-besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z24) ...
                +1i.*q0./x.^2.*E0z.*(-((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))+p0.*x.*(((l1-l).*(l1-l-1)./(p0.*x).^2-1).*besselj(l1-l,p0.*x)+besselj(l1-l+1,p0.*x)./(p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                -q0x.*E0y.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17))) ...
                +(-x.^2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f1-1, E1y
                +0.5.*(-1i.*d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(p1x.*E0y.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z22) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z32-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z22) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z24) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z19-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z17))) ...
                +1i.*(-x.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f2, E1y
                +0.5.*(-1i.*d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z24) ...
                +(l1-l).*wce.*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23)) ...
                +1i.*(-1i.*d1p.*((2.*x.^2-2-0.5./x.^2).*besselj(l-1,p1.*x)-(2.*x-0.5./x).*p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))+0.5.*p1.^2.*(((l-1).*(l-2)./(p1.*x).^2-1).*besselj(l-1,p1.*x)+besselj(l,p1.*x)./(p1.*x))) ...% f2-1, E1y
                +1i.*d1m.*((2.*x.^2-2-0.5./x.^2).*besselj(l+1,p1.*x)-(2.*x-0.5./x).*p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))+0.5.*p1.^2.*(((l+1).*(l)./(p1.*x).^2-1).*besselj(l+1,p1.*x)+besselj(l+2,p1.*x)./(p1.*x)))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z33-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z24) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23)) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f3, E1y
                .*((1-(l1-l).*wce).*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                +q0z./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(-2.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                +k1z.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z34-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z25)) ...
                +1i.*(-x.^2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f3-1, E1y
                +0.5.*(-1i.*d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23) ...
                +k1z.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z34-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z25)) ...
                +(p0x.*(p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x)) ...% f4, E1y
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z037-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z027) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z032-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z022)) ...
                +q1y./2.*(-1i.*d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015))) ...
                -(l1-l).*(1i./2./x.^2.*(-1i.*d1p.*(-besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                -1i.*d1m.*(-besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z038-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z026) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019)) ...
                -q1x.*p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015)))) ...
                +(p0x.*(besselj(l,p1.*x) ...% f4-1, E1y
                .*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z037-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z027) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z032-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z022)) ...
                +q1y.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015))) ...
                -(l1-l).*(1i./2./x.*(-1i.*d1p.*besselj(l-1,p1.*x)-1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z038-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z026) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019)) ...
                -q1x.*besselj(l,p1.*x).*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z030-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z015)))) ...
                +0.5i.*(-1i.*d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...% f5, E1y
                +1i.*d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z038-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z026) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019)) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f5-1, E1y
                .*(E0z.*(4.*x.*besselj(l1-l,p0.*x)-(4+1./x.^2).*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))+p0.^2./x.*(((l1-l).*(l1-l-1)./(p0.*x).^2-1).*besselj(l1-l,p0.*x)+besselj(l1-l+1,p0.*x)./(p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z038-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z026) ...
                +(E01.*((2.*x.^2-2-0.5./x.^2).*besselj(l1-l-1,p0.*x)-(2.*x-0.5./x).*p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))+0.5.*p0.^2.*(((l1-l-1).*(l1-l-2)./(p0.*x).^2-1).*besselj(l1-l-1,p0.*x)+besselj(l1-l,p0.*x)./(p0.*x))) ...
                +E02.*((2.*x.^2-2-0.5./x.^2).*besselj(l1-l+1,p0.*x)-(2.*x-0.5./x).*p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))+0.5.*p0.^2.*(((l1-l+1).*(l1-l)./(p0.*x).^2-1).*besselj(l1-l+1,p0.*x)+besselj(l1-l+2,p0.*x)./(p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z034-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z019)) ...
                +1i.*q1z./2.*(-1i.*d1p.*(besselj(l-1,p1.*x)+p1.*x.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...% f6, E1y
                +1i.*d1m.*(besselj(l+1,p1.*x)+p1.*x.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x)))) ...
                .*(-2.*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z039-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z025) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z040-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z028)) ...
                +1i.*q1z.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f6-1, E1y
                .*(2.*E0z.*(2.*x.*besselj(l1-l,p0.*x)-p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z039-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z025) ...
                +(2.*x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                -(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +(-2.*x.*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                +((1-(l1-l).*wce).*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                +q0z./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z040-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z028)) ...
                ) ...
                +1i.*((1+(n-l1).*wce).*cE0z.*besselj(-(n-l1),p0.*x)+q0z.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x))) ...% zy part5
                .*( ...
                zn1.*(-k1z).*( ...
                x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f1, E1y
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*Zp06 ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*Zp06+q0x.*E0z.*besselj(l1-l,p0.*x).*Zp02+q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Zp01) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)).*Zp05 ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)).*Zp02-q0x.*E0y.*besselj(l1-l,p0.*x).*Zp01)) ...
                +1i.*(-x.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f2, E1y
                +0.5.*(-1i.*d1p.*(1./x.*besselj(l-1,p1.*x)+p1.*((l-1).*besselj(l-1,p1.*x)./(p1.*x)-besselj(l,p1.*x))) ...
                +1i.*d1m.*(1./x.*besselj(l+1,p1.*x)+p1.*((l+1).*besselj(l+1,p1.*x)./(p1.*x)-besselj(l+2,p1.*x))))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Zp05 ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*Zp02) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f3, E1y
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*Zp02+k1z.*Zp04) ...
                +(p0x.*(besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x).*Z0p08+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p06) ...% f4, E1y
                +q1y.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*Z0p02+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p01)) ...
                -(l1-l).*(1i./2./x.*(-1i.*d1p.*besselj(l-1,p1.*x)-1i.*d1m.*besselj(l+1,p1.*x)) ...
                .*(E0z.*besselj(l1-l,p0.*x).*Z0p07+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p05) ...
                -q1x.*besselj(l,p1.*x).*(E0z.*besselj(l1-l,p0.*x).*Z0p02+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p01))) ...
                +1i.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f5, E1y
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))).*Z0p07 ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))).*Z0p05) ...
                +1i.*q1z.*x./2.*(-1i.*d1p.*besselj(l-1,p1.*x)+1i.*d1m.*besselj(l+1,p1.*x)) ...% f6, E1y
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*Z0p03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p02) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))).*Z0p04) ...
                ) ...
                ));
            szy = integral(fzy,0,inf);
            fzz = @(x) exp(-x.^2).*x.*besselj(n,p1.*x) ...% z
                .*( ...
                px.*cE0y.*besselj(-(n-l1),p0.*x) ...% zz part1
                .*( ...
                besselj(l,p1.*x) ...% f1, E1z
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*Z11 ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*Z11+q0x.*E0z.*besselj(l1-l,p0.*x).*Z10+q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z6) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)).*Z12 ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)).*Z10-q0x.*E0y.*besselj(l1-l,p0.*x).*Z6)) ...
                +1i.*(-2.*besselj(l,p1.*x)+p1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f2, E1z
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z12 ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*Z10) ...
                +1i.*besselj(l,p1.*x) ...% f3, E1z
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*Z10+(w1-l.*wce).*Z9) ...
                +(p0x.*q1y.*besselj(l,p1.*x)-(l1-l).*1i.*q1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f4, E1z
                .*(E0z.*besselj(l1-l,p0.*x).*Z09+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z03) ...
                +1i.*l.*wce./w1.*besselj(l,p1.*x) ...% f5, E1z
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))).*Z09 ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))).*Z03) ...
                +1i.*(1-l.*wce./w1).*besselj(l,p1.*x) ...% f6, E1z
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*Z09+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z03) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))).*Z012) ...
                ) ...
                +(-py) ...% zz part2
                .*( ...
                besselj(l,p1.*x) ...% f1, E1z
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z11+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z28+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z22) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z11+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z28+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z22) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z10+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z26+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z23) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z6+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z23+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z17)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z12+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z27+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z10+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z26+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z23) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z6+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z23+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z17))) ...
                +1i.*(-2.*besselj(l,p1.*x)+p1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f2, E1z
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z12+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z27+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z10+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z26+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z23)) ...
                +1i.*besselj(l,p1.*x) ...% f3, E1z
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(cE0x.*besselj(-(n-l1),p0.*x).*Z10+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z26+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z23) ...
                +(w1-l.*wce).*(cE0x.*besselj(-(n-l1),p0.*x).*Z9+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z25+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z21)) ...
                +(p0x.*q1y.*besselj(l,p1.*x)-(l1-l).*1i.*q1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f4, E1z
                .*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z09+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z025+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z016) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z03+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z016+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z015)) ...
                +1i.*l.*wce./w1.*besselj(l,p1.*x) ...% f5, E1z
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z09+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z025+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z016) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z03+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z016+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z015)) ...
                +1i.*(1-l.*wce./w1).*besselj(l,p1.*x) ...% f6, E1z
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*(cE0x.*besselj(-(n-l1),p0.*x).*Z09+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z025+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z016) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z03+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z016+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z015)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(cE0x.*besselj(-(n-l1),p0.*x).*Z012+q0x.*cE0z.*besselj(-(n-l1),p0.*x).*Z028+q0x.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z024)) ...
                ) ...
                +(-l1) ...% zz part3
                .*( ...
                besselj(l,p1.*x) ...% f1, E1z
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z35-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z28-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z22) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z35-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z28-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z22) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z27-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z26-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z23) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z23-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z17)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z36-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z27-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z24) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z27-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z26-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z23) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z23-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z17))) ...
                +1i.*(-2.*besselj(l,p1.*x)+p1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f2, E1z
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z36-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z27-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z24) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z27-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z26-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z23)) ...
                +1i.*besselj(l,p1.*x) ...% f3, E1z
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z27-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z26-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z23) ...
                +(w1-l.*wce).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z34-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z25-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z21)) ...
                +(p0x.*q1y.*besselj(l,p1.*x)-(l1-l).*1i.*q1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f4, E1z
                .*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z039-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z025-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z016) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z016-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z015)) ...
                +1i.*l.*wce./w1.*besselj(l,p1.*x) ...% f5, E1z
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z039-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z025-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z016) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z016-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z015)) ...
                +1i.*(1-l.*wce./w1).*besselj(l,p1.*x) ...% f6, E1z
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z039-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z025-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z016) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z016-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z015)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-0.5i./x.*(E03.*besselj(-(n-l1)-1,p0.*x)-E04.*besselj(-(n-l1)+1,p0.*x)).*Z040-1i.*q0./x.*cE0z.*((l1-n).*besselj(l1-n,p0.*x)./(p0.*x)-besselj(l1-n+1,p0.*x)).*Z028-q0x.*cE0y.*besselj(-(n-l1),p0.*x).*Z024)) ...
                ) ...
                +(1i./x) ...% zz part4
                .*( ...
                besselj(l,p1.*x) ...% f1, E1z
                .*(p1x.*E0y.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z35-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z28) ...
                -p1y.*(E0x.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z35-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z28) ...
                +q0x.*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z27-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z26) ...
                +q0x./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23)) ...
                -l.*(1i./2./x.^2.*(E01.*(-besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))-E02.*(-besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z36-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z27) ...
                +1i.*q0./x.^2.*E0z.*(-((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))+p0.*x.*(((l1-l).*(l1-l-1)./(p0.*x).^2-1).*besselj(l1-l,p0.*x)+besselj(l1-l+1,p0.*x)./(p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z27-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z26) ...
                -q0x.*E0y.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23))) ...
                +(-2.*x.*besselj(l,p1.*x)+p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f1-1, E1z
                .*(p1x.*E0y.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z35-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z28) ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z35-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z28) ...
                +q0x.*E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z27-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z26) ...
                +q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23)) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z36-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z27) ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z27-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z26) ...
                -q0x.*E0y.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z24-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z23))) ...
                +1i.*(-2.*besselj(l,p1.*x)+p1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f2, E1z
                .*(0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z36-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z27) ...
                +(l1-l).*wce.*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z27-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z26)) ...
                +1i.*(4.*x.*besselj(l,p1.*x) ...% f2-1, E1z
                -(4+1./x.^2).*p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x)) ...
                +p1.^2./x.*((l.*(l-1)./(p1.*x).^2-1).*besselj(l,p1.*x)+besselj(l+1,p1.*x)./(p1.*x))) ...
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z36-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z27) ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z27-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z26)) ...
                +1i.*besselj(l,p1.*x) ...% f3, E1z
                .*((1-(l1-l).*wce).*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                +q0z./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(-2.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z27-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z26) ...
                +(w1-l.*wce).*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z34-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z25)) ...
                +1i.*(-2.*x.*besselj(l,p1.*x)+p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f3-1, E1z
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z27-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z26) ...
                +(w1-l.*wce).*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z34-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z25)) ...
                +(p0x.*q1y.*p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x)) ...% f4, E1z
                -(l1-l).*1i.*q1./x.*(-1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))+p1.*((l.*(l-1)./(p1.*x).^2-1).*besselj(l,p1.*x)+besselj(l+1,p1.*x)./(p1.*x)))) ...
                .*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z039-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z025) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016)) ...
                +(p0x.*q1y.*besselj(l,p1.*x)-(l1-l).*1i.*q1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f4-1, E1z
                .*(E0z.*(-2.*x.*besselj(l1-l,p0.*x)+p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z039-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z025) ...
                +(-x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016)) ...
                +1i.*l.*wce./w1.*p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x)) ...% f5, E1z
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z039-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z025) ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016)) ...
                +1i.*l.*wce./w1.*besselj(l,p1.*x) ...% f5-1, E1z
                .*(E0z.*(4.*x.*besselj(l1-l,p0.*x)-(4+1./x.^2).*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))+p0.^2./x.*(((l1-l).*(l1-l-1)./(p0.*x).^2-1).*besselj(l1-l,p0.*x)+besselj(l1-l+1,p0.*x)./(p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z039-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z025) ...
                +(E01.*((2.*x.^2-2-0.5./x.^2).*besselj(l1-l-1,p0.*x)-(2.*x-0.5./x).*p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))+0.5.*p0.^2.*(((l1-l-1).*(l1-l-2)./(p0.*x).^2-1).*besselj(l1-l-1,p0.*x)+besselj(l1-l,p0.*x)./(p0.*x))) ...
                +E02.*((2.*x.^2-2-0.5./x.^2).*besselj(l1-l+1,p0.*x)-(2.*x-0.5./x).*p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))+0.5.*p0.^2.*(((l1-l+1).*(l1-l)./(p0.*x).^2-1).*besselj(l1-l+1,p0.*x)+besselj(l1-l+2,p0.*x)./(p0.*x)))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016)) ...
                +1i.*(1-l.*wce./w1).*p1.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x)) ...% f6, E1z
                .*(-2.*(E0z.*besselj(l1-l,p0.*x) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z039-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z025) ...
                +x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016)) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z040-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z028)) ...
                +1i.*(1-l.*wce./w1).*besselj(l,p1.*x) ...% f6-1, E1z
                .*(2.*E0z.*(2.*x.*besselj(l1-l,p0.*x)-p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z039-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z025) ...
                +(2.*x.^2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                -(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z035-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z016) ...
                +(-2.*x.*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                +((1-(l1-l).*wce).*E0z.*p0.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)) ...
                +q0z./2.*(E01.*(besselj(l1-l-1,p0.*x)+p0.*x.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x)))+E02.*(besselj(l1-l+1,p0.*x)+p0.*x.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x)))))) ...
                .*(x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x)).*Z040-(n-l1).*wce.*cE0z.*besselj(-(n-l1),p0.*x).*Z028)) ...
                ) ...
                +1i.*((1+(n-l1).*wce).*cE0z.*besselj(-(n-l1),p0.*x)+q0z.*x./2.*(E03.*besselj(-(n-l1)-1,p0.*x)+E04.*besselj(-(n-l1)+1,p0.*x))) ...% zz part5
                .*( ...
                zn1.*(-k1z).*( ...
                besselj(l,p1.*x) ...% f1, E1z
                .*(p1x.*E0y.*besselj(l1-l,p0.*x).*Zp08 ...
                -p1y.*(E0x.*besselj(l1-l,p0.*x).*Zp08+q0x.*E0z.*besselj(l1-l,p0.*x).*Zp03+q0x.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Zp02) ...
                -l.*(1i./2./x.*(E01.*besselj(l1-l-1,p0.*x)-E02.*besselj(l1-l+1,p0.*x)).*Zp07 ...
                +1i.*q0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x)).*Zp03-q0x.*E0y.*besselj(l1-l,p0.*x).*Zp02)) ...
                +1i.*(-2.*besselj(l,p1.*x)+p1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f2, E1z
                .*(x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Zp07 ...
                +(l1-l).*wce.*E0z.*besselj(l1-l,p0.*x).*Zp03) ...
                +1i.*besselj(l,p1.*x) ...% f3, E1z
                .*((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))) ...
                .*(-2.*Zp03+(w1-l.*wce).*Zp04) ...
                +(p0x.*q1y.*besselj(l,p1.*x)-(l1-l).*1i.*q1./x.*(l.*besselj(l,p1.*x)./(p1.*x)-besselj(l+1,p1.*x))) ...% f4, E1z
                .*(E0z.*besselj(l1-l,p0.*x).*Z0p03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p02) ...
                +1i.*l.*wce./w1.*besselj(l,p1.*x) ...% f5, E1z
                .*((-2.*E0z.*besselj(l1-l,p0.*x)+p0./x.*E0z.*((l1-l).*besselj(l1-l,p0.*x)./(p0.*x)-besselj(l1-l+1,p0.*x))).*Z0p03 ...
                +(-x.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)) ...
                +0.5.*(E01.*(besselj(l1-l-1,p0.*x)./x+p0.*((l1-l-1).*besselj(l1-l-1,p0.*x)./(p0.*x)-besselj(l1-l,p0.*x))) ...
                +E02.*(besselj(l1-l+1,p0.*x)./x+p0.*((l1-l+1).*besselj(l1-l+1,p0.*x)./(p0.*x)-besselj(l1-l+2,p0.*x))))).*Z0p02) ...
                +1i.*(1-l.*wce./w1).*besselj(l,p1.*x) ...% f6, E1z
                .*(-2.*(E0z.*besselj(l1-l,p0.*x).*Z0p03+x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x)).*Z0p02) ...
                +((1-(l1-l).*wce).*E0z.*besselj(l1-l,p0.*x)+q0z.*x./2.*(E01.*besselj(l1-l-1,p0.*x)+E02.*besselj(l1-l+1,p0.*x))).*Z0p04) ...
                ) ...
                ));
            szz = integral(fzz,0,inf);
            SigNLxx = SigNLxx+exp(1i.*(n-l).*de1).*sxx;
            SigNLxy = SigNLxy+exp(1i.*(n-l).*de1).*sxy;
            SigNLxz = SigNLxz+exp(1i.*(n-l).*de1).*sxz;
            SigNLyx = SigNLyx+exp(1i.*(n-l).*de1).*syx;
            SigNLyy = SigNLyy+exp(1i.*(n-l).*de1).*syy;
            SigNLyz = SigNLyz+exp(1i.*(n-l).*de1).*syz;
            SigNLzx = SigNLzx+exp(1i.*(n-l).*de1).*szx;
            SigNLzy = SigNLzy+exp(1i.*(n-l).*de1).*szy;
            SigNLzz = SigNLzz+exp(1i.*(n-l).*de1).*szz;
        end
    end
end
y = (0.048./81.9./ve.*30./w0).^2.*wpe.^2./w1.*[SigNLxx SigNLxy SigNLxz
    SigNLyx SigNLyy SigNLyz
    SigNLzx SigNLzy SigNLzz];